<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Changelog • gratia</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Changelog" />
<meta property="og:image" content="https://gavinsimpson.github.io/gratia/reference/figures/README-draw-gam-figure-1.png" />
<meta property="og:image:alt" content="Plot produced by draw() of 4 smooth functions from a fitted generalized additive model" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:creator" content="@ucfagls" />
<meta name="twitter:site" content="@ucfagls" />






<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  

  

  </head>

  <body data-spy="scroll" data-target="#toc">
    

    <div class="container template-news">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gratia</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.6.0.9113</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/gavinsimpson/gratia/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
      <h1 data-toc-skip>Changelog <small></small></h1>
      <small>Source: <a href='https://github.com/gavinsimpson/gratia/blob/master/NEWS.md'><code>NEWS.md</code></a></small>
    </div>

    <div id="gratia-069113" class="section level1">
<h1 class="page-header" data-toc-text="0.6.9113">
<a href="#gratia-069113" class="anchor" aria-hidden="true"></a>gratia 0.6.9113<small> Unreleased </small></h1>
<div id="major-changes" class="section level2">
<h2 class="hasAnchor">
<a href="#major-changes" class="anchor" aria-hidden="true"></a>Major changes</h2>
<ul><li>
<p><code><a href="../reference/draw.gam.html">draw.gam()</a></code> now uses <code><a href="../reference/smooth_estimates.html">smooth_estimates()</a></code> internally and consequently uses its <code><a href="../reference/draw.html">draw()</a></code> method and underlying plotting code. This has simplified the code compared to <code><a href="../reference/evaluate_smooth.html">evaluate_smooth()</a></code> and its methods, which will allow for future development and addition of features more easily than if <code>evaluate_Smooth()</code> had been retained.</p>
<p>While a lot of code has been reused so differences between plots as a result of this change should be minimal, some corner cases may have been missed. File and Issue if you notice something that has changed that you think shouldn’t.</p>
</li>
</ul></div>
<div id="new-features" class="section level2">
<h2 class="hasAnchor">
<a href="#new-features" class="anchor" aria-hidden="true"></a>New features</h2>
<ul><li><p><code><a href="../reference/rootogram.html">rootogram()</a></code> and its <code><a href="../reference/draw.html">draw()</a></code> method produce rootograms as diagnostic plots for fitted models. Currently only for models fitted with <code><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson()</a></code>, <code><a href="https://rdrr.io/pkg/mgcv/man/negbin.html" class="external-link">nb()</a></code>, <code><a href="https://rdrr.io/pkg/mgcv/man/negbin.html" class="external-link">negbin()</a></code>, <code><a href="https://rdrr.io/r/stats/family.html" class="external-link">gaussian()</a></code> families.</p></li>
<li><p><code><a href="../reference/nb_theta.html">nb_theta()</a></code> is a new extractor function that returns the theta parameter of a fitted negative binomial GAM (families <code><a href="https://rdrr.io/pkg/mgcv/man/negbin.html" class="external-link">nb()</a></code> or <code><a href="https://rdrr.io/pkg/mgcv/man/negbin.html" class="external-link">negbin()</a></code>).</p></li>
<li><p><code><a href="../reference/edf.html">edf()</a></code> extracts the effective degrees of freedom (EDF) of a fitted model or a specific smooth in the model. Various forms for the EDF can be extracted.</p></li>
<li>
<p><code><a href="../reference/draw.gam.html">draw.gam()</a></code> can now show a “rug” plot on a bivariate smooth by drawing small points with high transparency over the smooth surface at the data coordinates.</p>
<p>In addition, the rugs on plots of factor by smooths now show the locations of covariate values for the specific level of the factor and not over all levels. This better reflects what data were used to estimate the smooth, even though the basis for each smooth was set up using all of the covariate locations.</p>
</li>
<li><p>Partial residuals can now be plotted on factor by smooths. To allow this, the partial residuals are filtered so that only residuals associated with a particular level’s smooth are drawn on the plot of the smooth.</p></li>
<li><p><code><a href="../reference/smooth_estimates.html">smooth_estimates()</a></code> uses <code><a href="../reference/check_user_select_smooths.html">check_user_select_smooths()</a></code> to handle user-specified selection of smooth terms. As such it is more flexible than previously, and allows for easier selection of smooths to evaluate.</p></li>
</ul></div>
<div id="bug-fixes" class="section level2">
<h2 class="hasAnchor">
<a href="#bug-fixes" class="anchor" aria-hidden="true"></a>Bug fixes</h2>
<ul><li><p><code><a href="../reference/smooth_estimates.html">smooth_estimates()</a></code> was not filtering user-supplied data for the by level of the specific smooth when used with by factor smooths. This would result in the smooth being evaluated at all rows of the user-supplied data, and therefore would result in <code>nrow(user_data) * nlevels(by_variable)</code> rows in the returned object instead of <code>nrow(user_data)</code> rows.</p></li>
<li><p>The <code><a href="../reference/add_confint.html">add_confint()</a></code> method for <code><a href="../reference/smooth_estimates.html">smooth_estimates()</a></code> had the upper and lower intervals reversed. <a href='https://github.com/gavinsimpson/gratia/issues/107'>#107</a> Reported by <a href='https://github.com/Aariq'>@Aariq</a></p></li>
</ul></div>
</div>
    <div id="gratia-060" class="section level1">
<h1 class="page-header" data-toc-text="0.6.0">
<a href="#gratia-060" class="anchor" aria-hidden="true"></a>gratia 0.6.0<small> 2021-04-18 </small></h1>
<div id="major-changes-1" class="section level2">
<h2 class="hasAnchor">
<a href="#major-changes-1" class="anchor" aria-hidden="true"></a>Major changes</h2>
<ul><li>
<p>The {cowplot} package has been replaced by the {patchwork} package for producing multi-panel figures in <code><a href="../reference/draw.html">draw()</a></code> and <code><a href="../reference/appraise.html">appraise()</a></code>. This shouldn’t affect any code that used {gratia} only, but if you passed additional arguments to <code>cowplot::plot_grid()</code> or used the <code>align</code> or <code>axis</code> arguments of <code><a href="../reference/draw.html">draw()</a></code> and <code><a href="../reference/appraise.html">appraise()</a></code>, you’ll need to adapt code accordingly.</p>
<p>Typically, you can simply delete the <code>align</code> or <code>axis</code> arguments and {patchwork} will just work and align plots nicely. Any arguments passed via <code>...</code> to <code>cowplot::plot_grid()</code> will just be ignored by <code><a href="https://patchwork.data-imaginist.com/reference/wrap_plots.html" class="external-link">patchwork::wrap_plots()</a></code> unless those passed arguments match any of the arguments of <code><a href="https://patchwork.data-imaginist.com/reference/wrap_plots.html" class="external-link">patchwork::wrap_plots()</a></code>.</p>
</li>
</ul></div>
<div id="new-features-1" class="section level2">
<h2 class="hasAnchor">
<a href="#new-features-1" class="anchor" aria-hidden="true"></a>New features</h2>
<ul><li><p>The {patchwork} package is now used for multi-panel figures. As such, {gratia} no longer Imports from the {cowplot} package.</p></li>
<li>
<p>Worm plot diagnostic plots are available via new function <code><a href="../reference/worm_plot.html">worm_plot()</a></code>. Worm plots are detrended Q-Q plots, where deviation from the Q-Q reference line are emphasized as deviations around the line occupy the full height of the plot.</p>
<p><code><a href="../reference/worm_plot.html">worm_plot()</a></code> methods are available for models of classes <code>"gam"</code>, <code>"glm"</code>, and <code>"lm"</code>. (<a href='https://github.com/gavinsimpson/gratia/issues/62'>#62</a>)</p>
</li>
<li>
<p>Smooths can now be compared across models using <code><a href="../reference/compare_smooths.html">compare_smooths()</a></code>, and comparisons visualised with the associated <code><a href="../reference/draw.html">draw()</a></code> method. (<a href='https://github.com/gavinsimpson/gratia/issues/85'>#85</a> <a href='https://github.com/dill'>@dill</a>)</p>
<p>This feature is a bit experimental; the returned object uses nested lists and may change in the future if users find this confusing.</p>
</li>
<li><p>The reference line in <code><a href="../reference/qq_plot.html">qq_plot()</a></code> with <code>method = "normal"</code> was previously drawn as a line with intercept 0 and slope 1, to match the other methods. This was inconsistent with <code><a href="https://rdrr.io/r/stats/qqnorm.html" class="external-link">stats::qqplot()</a></code> which drew the line through the 1st and 3rd quartiles. <code><a href="../reference/qq_plot.html">qq_plot()</a></code> with <code>method = "normal"</code> now uses this robust reference line. Reference lines for the other methods remain drawn with slope 1 and intercept 0.</p></li>
<li><p><code><a href="../reference/qq_plot.html">qq_plot()</a></code> with <code>method = "normal"</code> now draws a point-wise reference band using the standard error of the order statistic.</p></li>
<li><p>The <code><a href="../reference/draw.html">draw()</a></code> method for <code><a href="../reference/penalty.html">penalty()</a></code> now plots the penalty matrix heatmaps in a more-logical orientation, to match how the matrices might be written down or printed to the R console.</p></li>
<li><p><code><a href="../reference/link.html">link()</a></code>, and <code><a href="../reference/link.html">inv_link()</a></code> now work for models fitted with the <code><a href="https://rdrr.io/pkg/mgcv/man/gumbls.html" class="external-link">gumbls()</a></code> and <code><a href="https://rdrr.io/pkg/mgcv/man/shash.html" class="external-link">shash()</a></code> families. (<a href='https://github.com/gavinsimpson/gratia/issues/84'>#84</a>)</p></li>
<li><p><code><a href="../reference/link.html">extract_link()</a></code> is a lower level utility function related to <code><a href="../reference/link.html">link()</a></code> and <code><a href="../reference/link.html">inv_link()</a></code>, and is now exported.</p></li>
</ul></div>
<div id="user-visible-changes" class="section level2">
<h2 class="hasAnchor">
<a href="#user-visible-changes" class="anchor" aria-hidden="true"></a>User visible changes</h2>
<ul><li><p>The default method name for generating reference quantiles in <code><a href="../reference/qq_plot.html">qq_plot()</a></code> was changed from <code>"direct"</code> to <code>"uniform"</code>, to avoid confusion with the <code><a href="https://rdrr.io/pkg/mgcv/man/qq.gam.html" class="external-link">mgcv::qq.gam()</a></code> help page description of the methods. Accordingly using <code>method = "direct"</code> is deprecated and a message to this effect is displayed if used.</p></li>
<li><p>The way smooths/terms are selected in <code><a href="../reference/derivatives.html">derivatives()</a></code> has been switched to use the same mechanism as <code><a href="../reference/draw.gam.html">draw.gam()</a></code>’s <code>select</code> argument. To get a partial match to <code>term</code>, you now need to also specify <code>partial_match = TRUE</code> in the call to <code><a href="../reference/derivatives.html">derivatives()</a></code>.</p></li>
</ul></div>
<div id="bug-fixes-1" class="section level2">
<h2 class="hasAnchor">
<a href="#bug-fixes-1" class="anchor" aria-hidden="true"></a>Bug fixes</h2>
<ul><li><p><code><a href="../reference/transform_fun.html">transform_fun()</a></code> had a copy paste bug in the definition of the then generic. (<a href='https://github.com/gavinsimpson/gratia/issues/96'>#96</a> <a href='https://github.com/Aariq'>@Aariq</a>)</p></li>
<li><p><code><a href="../reference/derivatives.html">derivatives()</a></code> with user-supplied <code>newdata</code> would fail for factor by smooths with <code>interval = "simultaneous"</code> and would introduce rows with derivative == 0 with <code>interval = "confidence"</code> because it didn’t subset the rows of <code>newdata</code> for the specific level of the by factor when computing derivatives. (<a href='https://github.com/gavinsimpson/gratia/issues/102'>#102</a> <a href='https://github.com/sambweber'>@sambweber</a>)</p></li>
<li><p><code><a href="../reference/evaluate_smooth.html">evaluate_smooth()</a></code> can now handle random effect smooths defined using an ordered factor. (<a href='https://github.com/gavinsimpson/gratia/issues/99'>#99</a> <a href='https://github.com/StefanoMezzini'>@StefanoMezzini</a>)</p></li>
</ul></div>
</div>
    <div id="gratia-051" class="section level1">
<h1 class="page-header" data-toc-text="0.5.1">
<a href="#gratia-051" class="anchor" aria-hidden="true"></a>gratia 0.5.1<small> 2021-01-23 </small></h1>
<div id="new-features-2" class="section level2">
<h2 class="hasAnchor">
<a href="#new-features-2" class="anchor" aria-hidden="true"></a>New features</h2>
<ul><li>
<p><code><a href="../reference/smooth_estimates.html">smooth_estimates()</a></code> can now handle</p>
<ul><li>bivariate and multivariate thinplate regression spline smooths, e.g.  <code>s(x, z, a)</code>,</li>
<li>tensor product smooths (<code><a href="https://rdrr.io/pkg/mgcv/man/te.html" class="external-link">te()</a></code>, <code><a href="https://rdrr.io/pkg/mgcv/man/t2.html" class="external-link">t2()</a></code>, &amp; <code><a href="https://rdrr.io/pkg/mgcv/man/te.html" class="external-link">ti()</a></code>), e.g. <code>te(x, z, a)</code>
</li>
<li>factor smooth interactions, e.g. <code>s(x, f, bs = "fs")</code>
</li>
<li>random effect smooths, e.g. <code>s(f, bs = "re")</code>
</li>
</ul></li>
<li>
<p><code><a href="../reference/penalty.html">penalty()</a></code> provides a tidy representation of the penalty matrices of smooths. The tidy representation is most suitable for plotting with <code>ggplot()</code>.</p>
<p>A <code><a href="../reference/draw.html">draw()</a></code> method is provided, which represents the penalty matrix as a heatmap.</p>
</li>
</ul></div>
<div id="user-visible-changes-1" class="section level2">
<h2 class="hasAnchor">
<a href="#user-visible-changes-1" class="anchor" aria-hidden="true"></a>User visible changes</h2>
<ul><li>The <code>newdata</code> argument to <code><a href="../reference/smooth_estimates.html">smooth_estimates()</a></code> has been changed to <code>data</code> as was originally intended.</li>
</ul></div>
</div>
    <div id="gratia-050" class="section level1">
<h1 class="page-header" data-toc-text="0.5.0">
<a href="#gratia-050" class="anchor" aria-hidden="true"></a>gratia 0.5.0<small> 2021-01-10 </small></h1>
<div id="new-features-3" class="section level2">
<h2 class="hasAnchor">
<a href="#new-features-3" class="anchor" aria-hidden="true"></a>New features</h2>
<ul><li>
<p>Partial residuals for models can be computed with <code><a href="../reference/partial_residuals.html">partial_residuals()</a></code>. The partial residuals are the weighted residuals of the model added to the contribution of each smooth term (as returned by <code>predict(model, type = "terms")</code>.</p>
<p>Wish of <a href="https://github.com/gavinsimpson/gratia/issues/76" class="external-link">#76</a> (<a href='https://github.com/noamross'>@noamross</a>)</p>
<p>Also, new function <code><a href="../reference/add_partial_residuals.html">add_partial_residuals()</a></code> can be used to add the partial residuals to data frames.</p>
</li>
<li>
<p>Users can now control to some extent what colour or fill scales are used when plotting smooths in those <code><a href="../reference/draw.html">draw()</a></code> methods that use them. This is most useful to change the fill scale when plotting 2D smooths, or to change the discrete colour scale used when plotting random factor smooths (<code>bs = "fs"</code>).</p>
<p>The user can pass scales via arguments <code>discrete_colour</code> and <code>continuous_fill</code>.</p>
</li>
<li>
<p>The effects of certain smooths can be excluded from data simulated from a model using <code><a href="../reference/simulate.html">simulate.gam()</a></code> and <code><a href="../reference/predicted_samples.html">predicted_samples()</a></code> by passing <code>exclude</code> or <code>terms</code> on to <code><a href="https://rdrr.io/pkg/mgcv/man/predict.gam.html" class="external-link">predict.gam()</a></code>. This allows for excluding random effects, for example, from model predicted values that are then used to simulate new data from the conditional distribution. See the example in <code><a href="../reference/predicted_samples.html">predicted_samples()</a></code>.</p>
<p>Wish of <a href="https://github.com/gavinsimpson/gratia/issues/74" class="external-link">#74</a> (<a href='https://github.com/hgoldspiel'>@hgoldspiel</a>)</p>
</li>
<li>
<p><code><a href="../reference/draw.gam.html">draw.gam()</a></code> and related functions gain arguments <code>constant</code> and <code>fun</code> to allow for user-defined constants and transformations of smooth estimates and confidence intervals to be applied.</p>
<p>Part of wish of Wish of <a href="https://github.com/gavinsimpson/gratia/issues/79" class="external-link">#79</a>.</p>
</li>
<li><p><code><a href="../reference/confint.gam.html">confint.gam()</a></code> now works for 2D smooths also.</p></li>
<li><p><code><a href="../reference/smooth_estimates.html">smooth_estimates()</a></code> is an early version of code to replace (or more likely supersede) <code><a href="../reference/evaluate_smooth.html">evaluate_smooth()</a></code>. <code><a href="../reference/smooth_estimates.html">smooth_estimates()</a></code> can currently only handle 1D smooths of the standard types.</p></li>
</ul></div>
<div id="user-visible-changes-2" class="section level2">
<h2 class="hasAnchor">
<a href="#user-visible-changes-2" class="anchor" aria-hidden="true"></a>User visible changes</h2>
<ul><li>
<p>The meaning of <code>parm</code> in <code>confint.gam</code> has changed. This argument now requires a smooth label to match a smooth. A vector of labels can be provided, but partial matching against a smooth label only works with a single <code>parm</code> value.</p>
<p>The default behaviour remains unchanged however; if <code>parm</code> is <code>NULL</code> then all smooths are evaluated and returned with confidence intervals.</p>
</li>
<li><p><code>data_class()</code> is no longer exported; it was only ever intended to be an internal function.</p></li>
</ul></div>
<div id="bug-fixes-2" class="section level2">
<h2 class="hasAnchor">
<a href="#bug-fixes-2" class="anchor" aria-hidden="true"></a>Bug Fixes</h2>
<ul><li>
<p><code><a href="../reference/confint.gam.html">confint.gam()</a></code> was failing on a tensor product smooth due to matching issues. Reported by <a href='https://github.com/tamas-ferenci'>@tamas-ferenci</a> <a href="https://github.com/gavinsimpson/gratia/issues/88" class="external-link">#88</a></p>
<p>This also fixes <a href="https://github.com/gavinsimpson/gratia/issues/80" class="external-link">#80</a></p>
<ol class="example" style="list-style-type: decimal"><li>which was a related issue with selecting a specific smooth.</li>
</ol></li>
<li><p>The <strong>vdiffr</strong> package is now used conditionally in package tests. Reported by Brian Ripley <a href="https://github.com/gavinsimpson/gratia/issues/93" class="external-link">#93</a></p></li>
</ul></div>
</div>
    <div id="gratia-041" class="section level1">
<h1 class="page-header" data-toc-text="0.4.1">
<a href="#gratia-041" class="anchor" aria-hidden="true"></a>gratia 0.4.1<small> 2020-05-30 </small></h1>
<div id="user-visible-changes-3" class="section level2">
<h2 class="hasAnchor">
<a href="#user-visible-changes-3" class="anchor" aria-hidden="true"></a>User visible changes</h2>
<ul><li>
<p><code><a href="../reference/draw.gam.html">draw.gam()</a></code> with <code>scales = "fixed"</code> now applies to all terms that can be plotted, including 2d smooths.</p>
<p>Reported by <a href='https://github.com/StefanoMezzini'>@StefanoMezzini</a> <a href="https://github.com/gavinsimpson/gratia/issues/73" class="external-link">#73</a></p>
</li>
</ul></div>
<div id="bug-fixes-3" class="section level2">
<h2 class="hasAnchor">
<a href="#bug-fixes-3" class="anchor" aria-hidden="true"></a>Bug fixes</h2>
<ul><li><p><code><a href="https://dplyr.tidyverse.org/reference/combine.html" class="external-link">dplyr::combine()</a></code> was deprecated. Switch to <code><a href="https://vctrs.r-lib.org/reference/vec_c.html" class="external-link">vctrs::vec_c()</a></code>.</p></li>
<li>
<p><code><a href="../reference/draw.gam.html">draw.gam()</a></code> with <code>scales = "fixed"</code> wasn’t using fixed scales where 2d smooths were in the model.</p>
<p>Reported by <a href='https://github.com/StefanoMezzini'>@StefanoMezzini</a> <a href="https://github.com/gavinsimpson/gratia/issues/73" class="external-link">#73</a></p>
</li>
</ul></div>
</div>
    <div id="gratia-040" class="section level1">
<h1 class="page-header" data-toc-text="0.4.0">
<a href="#gratia-040" class="anchor" aria-hidden="true"></a>gratia 0.4.0<small> Unreleased </small></h1>
<div id="new-features-4" class="section level2">
<h2 class="hasAnchor">
<a href="#new-features-4" class="anchor" aria-hidden="true"></a>New features</h2>
<ul><li><p><code><a href="../reference/draw.gam.html">draw.gam()</a></code> can now include partial residuals when drawing univariate smooths. Use <code>residuals = TRUE</code> to add partial residuals to each univariate smooth that is drawn. This feature is not available for smooths of more than one variable, by smooths, or factor-smooth interactions (<code>bs = "fs"</code>).</p></li>
<li>
<p>The coverage of credible and confidence intervals drawn by <code><a href="../reference/draw.gam.html">draw.gam()</a></code> can be specified via argument <code>ci_level</code>. The default is arbitrarily <code>0.95</code> for no other reason than (rough) compatibility with <code><a href="https://rdrr.io/pkg/mgcv/man/plot.gam.html" class="external-link">plot.gam()</a></code>.</p>
<p>This change has had the effect of making the intervals slightly narrower than in previous versions of <em>gratia</em>; intervals were drawn at ± 2 × the standard error. The default intervals are now drawn at ± ~1.96 × the standard error.</p>
</li>
<li><p>New function <code><a href="../reference/difference_smooths.html">difference_smooths()</a></code> for computing differences between factor smooth interactions. Methods available for <code><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">gam()</a></code>, <code><a href="https://rdrr.io/pkg/mgcv/man/bam.html" class="external-link">bam()</a></code>, <code><a href="https://rdrr.io/pkg/mgcv/man/gamm.html" class="external-link">gamm()</a></code> and <code><a href="https://rdrr.io/pkg/gamm4/man/gamm4.html" class="external-link">gamm4::gamm4()</a></code>. Also has a <code><a href="../reference/draw.html">draw()</a></code> method, which can handle differences of 1D and 2D smooths currently (handling 3D and 4D smooths is planned).</p></li>
<li><p>New functions <code><a href="../reference/add_fitted.html">add_fitted()</a></code> and <code><a href="../reference/add_residuals.html">add_residuals()</a></code> to add fitted values (expectations) and model residuals to an existing data frame. Currently methods available for objects fitted by <code><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">gam()</a></code> and <code><a href="https://rdrr.io/pkg/mgcv/man/bam.html" class="external-link">bam()</a></code>.</p></li>
<li><p><code><a href="../reference/data_sim.html">data_sim()</a></code> is a tidy reimplementation of <code><a href="https://rdrr.io/pkg/mgcv/man/gamSim.html" class="external-link">mgcv::gamSim()</a></code> with the added ability to use sampling distributions other than the Gaussian for all models implemented. Currently Gaussian, Poisson, and Bernoulli sampling distributions are available.</p></li>
<li><p><code><a href="../reference/smooth_samples.html">smooth_samples()</a></code> can handle continuous by variable smooths such as in varying coefficient models.</p></li>
<li><p><code><a href="../reference/link.html">link()</a></code> and <code><a href="../reference/link.html">inv_link()</a></code> now work for all families available in <em>mgcv</em>, including the location, scale, shape families, and the more specialised families described in <code><a href="https://rdrr.io/pkg/mgcv/man/family.mgcv.html" class="external-link">?mgcv::family.mgcv</a></code>.</p></li>
<li><p><code><a href="../reference/evaluate_smooth.html">evaluate_smooth()</a></code>, <code><a href="../reference/data_slice.html">data_slice()</a></code>, <code><a href="https://rdrr.io/r/stats/family.html" class="external-link">family()</a></code>, <code><a href="../reference/link.html">link()</a></code>, <code><a href="../reference/link.html">inv_link()</a></code> methods for models fitted using <code>gamm4()</code> from the <strong>gamm4</strong> package.</p></li>
<li><p><code><a href="../reference/data_slice.html">data_slice()</a></code> can generate data for a 1-d slice (a single variable varying).</p></li>
<li>
<p>The colour of the points, reference lines, and simulation band in <code><a href="../reference/appraise.html">appraise()</a></code> can now be specified via arguments</p>
<ul><li>
<code>point_col</code>,</li>
<li>
<code>point_alpha</code>,</li>
<li><code>ci_col</code></li>
<li><code>ci_alpha</code></li>
<li><code>line_col</code></li>
</ul><p>These are passed on to <code><a href="../reference/qq_plot.html">qq_plot()</a></code>, <code><a href="../reference/observed_fitted_plot.html">observed_fitted_plot()</a></code>, <code><a href="../reference/residuals_linpred_plot.html">residuals_linpred_plot()</a></code>, and <code><a href="../reference/residuals_hist_plot.html">residuals_hist_plot()</a></code>, which also now take the new arguments were applicable.</p>
</li>
<li><p>Added utility functions <code><a href="../reference/is_factor_term.html">is_factor_term()</a></code> and <code><a href="../reference/term_variables.html">term_variables()</a></code> for working with models. <code><a href="../reference/is_factor_term.html">is_factor_term()</a></code> identifies is the named term is a factor using information from the <code><a href="https://rdrr.io/r/stats/terms.html" class="external-link">terms()</a></code> object of the fitted model. <code><a href="../reference/term_variables.html">term_variables()</a></code> returns a character vector of variable names that are involved in a model term. These are strictly for working with parametric terms in models.</p></li>
<li>
<p><code><a href="../reference/appraise.html">appraise()</a></code> now works for models fitted by <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm()</a></code> and <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code>, as do the underlying functions it calls, especially <code>qq_plot</code>.</p>
<p><code><a href="../reference/appraise.html">appraise()</a></code> also works for models fitted with family <code><a href="https://rdrr.io/pkg/mgcv/man/gaulss.html" class="external-link">gaulss()</a></code>. Further location scale models and models fitted with extended family functions will be supported in upcoming releases.</p>
</li>
</ul></div>
<div id="user-visible-changes-4" class="section level2">
<h2 class="hasAnchor">
<a href="#user-visible-changes-4" class="anchor" aria-hidden="true"></a>User visible changes</h2>
<ul><li><p><code><a href="../reference/datagen.html">datagen()</a></code> is now an <em>internal</em> function and is no longer exported. Use <code><a href="../reference/data_slice.html">data_slice()</a></code> instead.</p></li>
<li><p><code><a href="../reference/evaluate_smooth.html">evaluate_parametric_term()</a></code> is now much stricter and can only evaluate main effect terms, i.e. those whose order, as stored in the <code>terms</code> object of the model is <code>1</code>.</p></li>
</ul></div>
<div id="bug-fixes-4" class="section level2">
<h2 class="hasAnchor">
<a href="#bug-fixes-4" class="anchor" aria-hidden="true"></a>Bug fixes</h2>
<ul><li><p>The <code><a href="../reference/draw.html">draw()</a></code> method for <code><a href="../reference/derivatives.html">derivatives()</a></code> was not getting the x-axis label for factor by smooths correctly, and instead was using <code>NA</code> for the second and subsequent levels of the factor.</p></li>
<li><p>The <code><a href="../reference/datagen.html">datagen()</a></code> method for class <code>"gam"</code> couldn’t possibly have worked for anything but the simplest models and would fail even with simple factor by smooths. These issues have been fixed, but the behaviour of <code><a href="../reference/datagen.html">datagen()</a></code> has changed, and the function is now not intended for use by users.</p></li>
<li><p>Fixed an issue where in models terms of the form <code>factor1:factor2</code> were incorrectly identified as being numeric parametric terms. <a href="https://github.com/gavinsimpson/gratia/issues/68" class="external-link">#68</a></p></li>
</ul></div>
</div>
    <div id="gratia-031" class="section level1">
<h1 class="page-header" data-toc-text="0.3.1">
<a href="#gratia-031" class="anchor" aria-hidden="true"></a>gratia 0.3.1<small> 2020-03-29 </small></h1>
<div id="new-features-5" class="section level2">
<h2 class="hasAnchor">
<a href="#new-features-5" class="anchor" aria-hidden="true"></a>New features</h2>
<ul><li>
<p>New functions <code><a href="../reference/link.html">link()</a></code> and <code><a href="../reference/link.html">inv_link()</a></code> to access the link function and its inverse from fitted models and family functions.</p>
<p>Methods for classes: <code>"glm"</code>, <code>"gam"</code>, <code>"bam"</code>, <code>"gamm"</code> currently. <a href="https://github.com/gavinsimpson/gratia/issues/58" class="external-link">#58</a></p>
</li>
<li><p>Adds explicit <code><a href="https://rdrr.io/r/stats/family.html" class="external-link">family()</a></code> methods for objects of classes <code>"gam"</code>, <code>"bam"</code>, and <code>"gamm"</code>.</p></li>
<li><p><code><a href="../reference/derivatives.html">derivatives()</a></code> now handles non-numeric when creating shifted data for finite differences. Fixes a problem with <code>stringsAsFactors = FALSE</code> default in R-devel. <a href="https://github.com/gavinsimpson/gratia/issues/64" class="external-link">#64</a></p></li>
</ul></div>
<div id="bug-fixes-5" class="section level2">
<h2 class="hasAnchor">
<a href="#bug-fixes-5" class="anchor" aria-hidden="true"></a>Bug fixes</h2>
<ul><li>Updated <em>gratia</em> to work with <em>tibble</em> versions &gt;= 3.0</li>
</ul></div>
</div>
    <div id="gratia-030" class="section level1">
<h1 class="page-header" data-toc-text="0.3.0">
<a href="#gratia-030" class="anchor" aria-hidden="true"></a>gratia 0.3.0<small> 2020-01-19 </small></h1>
<div id="new-features-6" class="section level2">
<h2 class="hasAnchor">
<a href="#new-features-6" class="anchor" aria-hidden="true"></a>New features</h2>
<ul><li><p><em>gratia</em> now uses the <em>mvnfast</em> package for random draws from a multivariate normal distribution (<code><a href="https://rdrr.io/pkg/mvnfast/man/rmvn.html" class="external-link">mvnfast::rmvn()</a></code>). Contributed by Henrik Singmann (<a href='https://github.com/singmann'>@singmann</a>) <a href="https://github.com/gavinsimpson/gratia/issues/28" class="external-link">#28</a></p></li>
<li><p>New function <code><a href="../reference/basis.html">basis()</a></code> for generating tidy representations of basis expansions from an <em>mgcv</em>-like definition of a smooth, e.g. <code><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s()</a></code>, <code><a href="https://rdrr.io/pkg/mgcv/man/te.html" class="external-link">te()</a></code>, <code><a href="https://rdrr.io/pkg/mgcv/man/te.html" class="external-link">ti()</a></code>, or <code><a href="https://rdrr.io/pkg/mgcv/man/t2.html" class="external-link">t2()</a></code>. The basic smooth types also have a simple <code><a href="../reference/draw.html">draw()</a></code> method for plotting the basis. <code><a href="../reference/basis.html">basis()</a></code> is a simple wrapper around <code><a href="https://rdrr.io/pkg/mgcv/man/smoothCon.html" class="external-link">mgcv::smoothCon()</a></code> with some post processing of the basis model matrix into a tidy format. <a href="https://github.com/gavinsimpson/gratia/issues/42" class="external-link">#42</a></p></li>
<li><p>New function <code><a href="../reference/smooth_samples.html">smooth_samples()</a></code> to draw samples of entire smooth functions from their posterior distribution. Also has a <code><a href="../reference/draw.html">draw()</a></code> method for plotting the posterior samples.</p></li>
</ul></div>
<div id="bug-fixes-6" class="section level2">
<h2 class="hasAnchor">
<a href="#bug-fixes-6" class="anchor" aria-hidden="true"></a>Bug fixes</h2>
<ul><li><p><code><a href="../reference/draw.gam.html">draw.gam()</a></code> would produce empty plots between the panels for the parametric terms if there were 2 or more parametric terms in a model. Reported by <a href='https://github.com/sklayn'>@sklayn</a> <a href="https://github.com/gavinsimpson/gratia/issues/39" class="external-link">#39</a>.</p></li>
<li>
<p><code><a href="../reference/derivatives.html">derivatives()</a></code> now works with factor by smooths, including ordered factor by smooths. The function also now works correctly for complex models with multiple covariates/smooths. <a href="https://github.com/gavinsimpson/gratia/issues/47" class="external-link">#47</a></p>
<p><code><a href="../reference/derivatives.html">derivatives()</a></code> also now handles <code>'fs'</code> smooths. Reported by <a href='https://github.com/tomand-uio'>@tomand-uio</a> <a href="https://github.com/gavinsimpson/gratia/issues/57" class="external-link">#57</a>.</p>
</li>
<li><p><code><a href="../reference/evaluate_smooth.html">evaluate_parametric_term()</a></code> and hence <code><a href="../reference/draw.gam.html">draw.gam()</a></code> would fail on a <code><a href="https://rdrr.io/pkg/mgcv/man/ziplss.html" class="external-link">ziplss()</a></code> model because i) <em>gratia</em> didn’t handle parametric terms in models with multiple linear predictors correctly, and ii) <em>gratia</em> didn’t convert to the naming convention of <em>mgcv</em> for terms in higher linear predictors. Reported by <a href='https://github.com/pboesu'>@pboesu</a> <a href="https://github.com/gavinsimpson/gratia/issues/45" class="external-link">#45</a>.</p></li>
</ul></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>

</div>


      <footer>
      <div class="copyright">
  <p><p>Developed by Gavin L. Simpson.</p></p>
</div>

<div class="pkgdown">
  <p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9001.</p></p>
</div>

      </footer>
   </div>

  


  

  </body>
</html>


